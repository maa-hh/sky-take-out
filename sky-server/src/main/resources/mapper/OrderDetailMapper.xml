<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sky.mapper.OrderDetailMapper">


    <insert id="insert" >
        INSERT INTO order_detail (
            name,
            order_id,
            dish_id,
            setmeal_id,
            dish_flavor,
            number,
            amount,
            image
        )
        VALUES (
                   #{name},
                   #{orderId},
                   #{dishId},
                   #{setmealId},
                   #{dishFlavor},
                   #{number},
                   #{amount},
                   #{image}
               )
    </insert>
    <insert id="batchinsert">
        INSERT INTO order_detail (
            name,
            order_id,
            dish_id,
            setmeal_id,
            dish_flavor,
            number,
            amount,
            image
        )
        values
        <foreach collection="orderDetailList" item="item" separator=",">
            (#{item.name},
            #{item.orderId},
            #{item.dishId},
            #{item.setmealId},
            #{item.dishFlavor},
            #{item.number},
            #{item.amount},
            #{item.image})
    </foreach>

    </insert>
    <select id="dishsalsenum" resultType="com.sky.dto.GoodsSalesDTO">
        select od.name,sum(od.number) as count from order_detail od join orders or on or.id=od.dish_id
        <where>
            <if test="begin!=null">
                and or.order_time &gt;#{begin}
            </if>
            <if test="end!=null">
                and or.order_time &lt;#{end}
            </if>
            and or.status=5
        </where>
        group by od.name
        order by count desc
        limit 0,10
    </select>

</mapper>


